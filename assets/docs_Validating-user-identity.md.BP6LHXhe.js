import{_ as t,c as i,o,ah as a}from"./chunks/framework.C9w-46Qr.js";const f=JSON.parse('{"title":"Validating user identity","description":"","frontmatter":{},"headers":[],"relativePath":"docs/Validating-user-identity.md","filePath":"docs/Validating-user-identity.md"}'),r={name:"docs/Validating-user-identity.md"};function n(d,e,s,l,c,h){return o(),i("div",null,[...e[0]||(e[0]=[a('<h1 id="validating-user-identity" tabindex="-1">Validating user identity <a class="header-anchor" href="#validating-user-identity" aria-label="Permalink to “Validating user identity”">​</a></h1><p>OAG forwards the identity of the user according to its configuration in one of the following ways: </p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>See <a href="/docs/Configuration-User-Mapping.html">Configure User mapping</a> for details on how to configure these options.</p></div><h2 id="signed-jwt-issued-by-oag-recommended" tabindex="-1">Signed JWT issued by OAG (recommended) <a class="header-anchor" href="#signed-jwt-issued-by-oag-recommended" aria-label="Permalink to “Signed JWT issued by OAG (recommended)”">​</a></h2><p>Most important is proper signature validation. For this you need the public key matching OAG&#39;s signing key. It is up to you how you make this key available to your application (e.g. within a keystore, using JWKS of OAG, providing BASE64 encoded in a config file, etc.). The recommended way is to use OAGs <a href="/docs/JWKS-JWT-signing-public-keys-of-OAG.html">JWKS endpoint</a>. If you take that route consider the following as the minimal verification your application should do after receiving the OAG Token (JWT):</p><ol><li>From the configured header sent by OAG extract the ID Token and read of the ID Token: <ul><li>kid -&gt; the id of the key used to sign the Token</li><li>jku -&gt; The url where the JWKS endpoint of OAG is published</li></ul></li><li>verify that jku points to a trusted / known domain (i.e. https://&lt;jourknownhost.domain&gt;:&lt;port&gt;/)</li><li>load the keys from jku and extract the key matching kid -&gt; this is the signing public key, SPK.</li></ol><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>Make sure you enable proper TLS hostname verification and use a truststore with minimal trusted CA certificates when establishing the https connection. Alternativile you can also use jku/kid to request the JWK with kid directly.</p></div><ol start="4"><li>Verify the signature of the Token with SPK according to <a href="https://tools.ietf.org/html/rfc7515" target="_blank" rel="noreferrer">RFC 7515</a></li><li>Verify the issuer (OAG, as configured)</li><li>Verify the audience (aud claim should be as configured and expected from your application)</li><li>verify the JWT according to your needs (See also: <a href="https://openid.net/specs/openid-connect-core-1_0.html" target="_blank" rel="noreferrer">OIDC</a> and <a href="https://datatracker.ietf.org/doc/html/rfc7519" target="_blank" rel="noreferrer">RFC7519</a>). At least this should include: <ul><li>exp -&gt; not expired</li><li>jti -&gt; when you do not expect repeated calls with the same token, or to check for tokens marked as &quot;invalid&quot;</li><li>sub -&gt; The user is granted access to the requested resource/action</li></ul></li></ol><h2 id="forwarded-jwt-of-the-original-authentication-server-oidc-server-recommended-only-when-oidc-server-is-owned-by-your-company-project-and-the-only-one" tabindex="-1">Forwarded JWT of the original authentication server (OIDC server) (recommended only when OIDC server is owned by your company/project and the only one) <a class="header-anchor" href="#forwarded-jwt-of-the-original-authentication-server-oidc-server-recommended-only-when-oidc-server-is-owned-by-your-company-project-and-the-only-one" aria-label="Permalink to “Forwarded JWT of the original authentication server (OIDC server) (recommended only when OIDC server is owned by your company/project and the only one)”">​</a></h2><p>Verify the forwarded JWT/Access Token as specified by the OIDC server / authentication server.</p><h2 id="header-fields-with-user-data-not-recommended-for-legacy-integration-only" tabindex="-1">Header fields with user data (not recommended, for legacy integration only) <a class="header-anchor" href="#header-fields-with-user-data-not-recommended-for-legacy-integration-only" aria-label="Permalink to “Header fields with user data (not recommended, for legacy integration only)”">​</a></h2><p>Verify the headers according to your needs and custom security concept.</p>',12)])])}const p=t(r,[["render",n]]);export{f as __pageData,p as default};
