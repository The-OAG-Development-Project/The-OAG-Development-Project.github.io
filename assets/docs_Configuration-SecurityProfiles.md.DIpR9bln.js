import{_ as i,c as a,o as e,ah as t}from"./chunks/framework.C9w-46Qr.js";const E=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"docs/Configuration-SecurityProfiles.md","filePath":"docs/Configuration-SecurityProfiles.md"}'),n={name:"docs/Configuration-SecurityProfiles.md"};function h(l,s,p,r,k,o){return e(),a("div",null,[...s[0]||(s[0]=[t(`<p>Security profiles allow you to define different security behavior for different routes. OAG already comes with a <a href="#predefined-profiles">predefined set of security profiles</a> that cover most use-cases. However, you can always add your own profile in the config file or overwrite a default security profile.</p><p>Example :</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">securityProfiles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  webapplication</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    allowedMethods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GET&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PUT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PATCH&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;DELETE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OPTIONS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HEAD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    csrfProtection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">samesite-strict-cookie</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    csrfSafeMethods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GET&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;OPTIONS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HEAD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    responseHeaders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;&lt;remove&gt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      X-Powered-By</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;&lt;remove&gt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      X-XSS-Protection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">1; mode=block;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      X-Frame-Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SAMEORIGIN</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      X-Content-Type-Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nosniff</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      Referrer-Policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">strict-origin-when-cross-origin</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      Content-Security-Policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">upgrade-insecure-requests;base-uri &#39;self&#39;;object-src &#39;self&#39;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      Permissions-Policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">geolocation=(),notifications=(),push=(),microphone=(),camera=(),speaker=(),vibrate=(),fullscreen=(),payment=(),usb=(),magnetometer=(),gyroscope=(),accelerometer=()</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      Strict-Transport-Security</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">max-age=31536000; includeSubDomains</span></span></code></pre></div><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to “Configuration”">​</a></h2><h3 id="name-webapplication" tabindex="-1">name -&gt; webapplication <a class="header-anchor" href="#name-webapplication" aria-label="Permalink to “name -&gt; webapplication”">​</a></h3><p>Each security profile needs a unique name (webapplication in the example above). For predefined names <a href="#predefined-profiles">see below</a>.</p><h3 id="allowedmethods" tabindex="-1"><code>allowedMethods</code> <a class="header-anchor" href="#allowedmethods" aria-label="Permalink to “allowedMethods”">​</a></h3><p>Defines the allowed HTTP method. Requests with HTTP methods that are not whitelisted will be blocked with a <code>405 Method Not Allowed</code> response. HTTP Methods are documented for example at <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods" target="_blank" rel="noreferrer">Mozilla Developer Network</a>. From a security point of view you should only enable the Methods required for your application to work.</p><h3 id="csrfprotection" tabindex="-1"><code>csrfProtection</code> <a class="header-anchor" href="#csrfprotection" aria-label="Permalink to “csrfProtection”">​</a></h3><p>Defines the type of CSRF Protection. Please check <a href="#csrf-protections">here</a> further down in this document for more details.</p><h3 id="csrfsafemethods" tabindex="-1"><code>csrfSafeMethods</code> <a class="header-anchor" href="#csrfsafemethods" aria-label="Permalink to “csrfSafeMethods”">​</a></h3><p>Defines the list of HTTP methods that are excluded from the CSRF protection.</p><h3 id="responseheaders" tabindex="-1"><code>responseHeaders</code> <a class="header-anchor" href="#responseheaders" aria-label="Permalink to “responseHeaders”">​</a></h3><p>By default OAG returns all headers set by the downstream-service response to the client. You can manipulate this with actions defined in this section. The existing actions for response headers are currently, the following types:</p><ul><li><code>&lt;&lt;remove&gt;&gt;</code> Removes the header from the response.</li><li><code>value</code> sets or overwrites the header in the response.</li></ul><p>In the example below the <code>Server</code> header is of type <code>&lt;&lt;remove&gt;&gt;</code> and therefore removed if set in the response from the downstream-service (clients will never see a <code>Server</code> header). The <code>X-Content-Type-Options</code> header is of type <code>value</code> and therefore overwrites an existing header of the same name or adds it if no such header exists in the response of the downstream service (clients will always see <code>X-Content-Type-Options: nosniff</code> regardless of what the downstream service sets.</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   responseHeaders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#Here you can add a set of response header</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;&lt;remove&gt;&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Use &lt;&lt;remove&gt;&gt; to remove a header from the backend response</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      X-Content-Type-Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nosniff</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # OAG adds the X-Content-Type-Options with the nosniff value to each response. Existing header will be overwritten.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      ...</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # You can add as many different headers as you want</span></span></code></pre></div><p>For details regarding what headers you might want to remove or add, see for example <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Headers_Cheat_Sheet.html" target="_blank" rel="noreferrer">OWASP Cheatsheet</a>.</p><h3 id="usermapping" tabindex="-1"><code>userMapping</code> <a class="header-anchor" href="#usermapping" aria-label="Permalink to “userMapping”">​</a></h3><p>Defines the way how OAG tells the backend who the user is. See also: <a href="https://github.com/gianlucafrei/Application-Gateway/wiki/Configuration:-User-Mapping" target="_blank" rel="noreferrer">User Mapping</a></p><h2 id="predefined-profiles" tabindex="-1">Predefined Profiles <a class="header-anchor" href="#predefined-profiles" aria-label="Permalink to “Predefined Profiles”">​</a></h2><ul><li><code>static</code>: This is for static content. It adds default security headers and only allowed the GET, HEAD, and OPTIONS method. If you have a single page application this is profile is suitable to host static application files.</li><li><code>webapplication</code>: This profile is suitable for most webapplications. It allows all default normal http methods and adds csrf protection via samesite cookie.</li><li><code>apiforspa</code> Use this profile if you have an API that is called from the web-browser. It adds csrf protection with the double submit cookit pattern. You need to implement the custom header when you call the api from your code.</li><li><code>apifornonebrowsers</code> Use this profile only for apis that are not called from the browser. It removes most security functionality of OAG.</li></ul><p>You can see the detailed configuration of all predefined profiles in the default configuration file: <a href="https://github.com/The-OAG-Development-Project/Application-Gateway/blob/main/oag/src/main/resources/default-config.yaml" target="_blank" rel="noreferrer">https://github.com/The-OAG-Development-Project/Application-Gateway/blob/main/oag/src/main/resources/default-config.yaml</a></p><h2 id="csrf-protections" tabindex="-1">CSRF Protections <a class="header-anchor" href="#csrf-protections" aria-label="Permalink to “CSRF Protections”">​</a></h2><p>OAG implements the following strategies for csrf protection.</p><h3 id="double-submit-cookie" tabindex="-1"><code>double-submit-cookie</code> <a class="header-anchor" href="#double-submit-cookie" aria-label="Permalink to “double-submit-cookie”">​</a></h3><p>With this mode OAG requires the <code>csrf</code> cookie in the <code>X-CSRF-TOKEN</code> header. This method of csrf protection in only applicable for XHR requests and recommened when you have a singe page application. If you use form posts you can also add the token as a hidden field with name <code>CSRFToken</code> to the form.</p><p>This method of csrf protection is the strongest because OAG cryptographically binds the csrf cookie to the session cookie, but the downside of this method is that your application needs to implement the following logic for every XHR request:</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text/javascript&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    function getCookie(name) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       var nameEQ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;=&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">       var ca </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> document.cookie.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">split</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(var i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ca.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            var c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ca[i];</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            while</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (c.charAt(0)==&#39; &#39;) c = c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(1,c.length);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (c.indexOf(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">nameEQ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) == 0) return c.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nameEQ.length,c.length);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        return </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    var csrf_token = getCookie(&#39;csrf&#39;);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    function csrfSafeMethod(method) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // these HTTP methods do not require CSRF protection</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">(GET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">HEAD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">OPTIONS)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">test</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(method));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    var o = XMLHttpRequest.prototype.open;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    XMLHttpRequest.prototype.open = function(){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        var res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> o.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">arguments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        var err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">csrfSafeMethod</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">arguments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            this.setRequestHeader(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;X-CSRF-TOKEN&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, csrf_token);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        return res;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><hr><h3 id="samesite-strict-cookie" tabindex="-1"><code>samesite-strict-cookie</code> <a class="header-anchor" href="#samesite-strict-cookie" aria-label="Permalink to “samesite-strict-cookie”">​</a></h3><p>With this mode, OAG uses a same-site strict cookie to protect your users from csrf attacks.</p><p>Most browsers except IE do implement the same-site strict cookie. See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" target="_blank" rel="noreferrer">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite</a>.</p><hr><h3 id="none" tabindex="-1"><code>none</code> <a class="header-anchor" href="#none" aria-label="Permalink to “none”">​</a></h3><p>OAG does not protect you against any csrf attack. Use this if your route does not need any csrf protection (for example only static content) or if you implemented csrf protection in your backend</p><h2 id="example-configuration" tabindex="-1">Example configuration <a class="header-anchor" href="#example-configuration" aria-label="Permalink to “Example configuration”">​</a></h2><p>A security profile consists of the following configuration values:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   allowedMethods</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GET&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PUT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;POST&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ] </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># List if allowed http methods</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   csrfProtection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">doubleSubmitCookie</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # type of csrf protection</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">   responseHeaders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#Here you can add a set of response header</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">     Server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;&lt;remove&gt;&gt;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Use &lt;&lt;remove&gt;&gt; to remove a header from the backend response</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">     X-Content-Type-Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nosniff</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # OAG adds the X-Content-Type-Options with the nosniff value to each response. Existing header will be overwritten.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">     ...</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # You can add as many different headers as you want</span></span></code></pre></div>`,39)])])}const c=i(n,[["render",h]]);export{E as __pageData,c as default};
