<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Security Profiles | OWASP-Application-Gateway</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="OWASP Application Gateway is an HTTP proxy that handles Oauth2 authentication and session management">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.d74e1dbf.css" as="style"><link rel="preload" href="/assets/js/app.80938ac1.js" as="script"><link rel="preload" href="/assets/js/2.699db687.js" as="script"><link rel="preload" href="/assets/js/1.6f7f3e11.js" as="script"><link rel="preload" href="/assets/js/28.a821b188.js" as="script"><link rel="prefetch" href="/assets/js/10.bc770b30.js"><link rel="prefetch" href="/assets/js/11.4eb6f50c.js"><link rel="prefetch" href="/assets/js/12.a4dadbb2.js"><link rel="prefetch" href="/assets/js/13.2997afc4.js"><link rel="prefetch" href="/assets/js/14.353d6eef.js"><link rel="prefetch" href="/assets/js/15.7e8a42c3.js"><link rel="prefetch" href="/assets/js/16.080d0551.js"><link rel="prefetch" href="/assets/js/17.68d7fb70.js"><link rel="prefetch" href="/assets/js/18.fc93894c.js"><link rel="prefetch" href="/assets/js/19.59a8dd5e.js"><link rel="prefetch" href="/assets/js/20.a728a170.js"><link rel="prefetch" href="/assets/js/21.8f6f4046.js"><link rel="prefetch" href="/assets/js/22.4d277477.js"><link rel="prefetch" href="/assets/js/23.7fb60023.js"><link rel="prefetch" href="/assets/js/24.45dce4ba.js"><link rel="prefetch" href="/assets/js/25.25e30095.js"><link rel="prefetch" href="/assets/js/26.d7867109.js"><link rel="prefetch" href="/assets/js/27.fc8464e5.js"><link rel="prefetch" href="/assets/js/29.1bebf4e2.js"><link rel="prefetch" href="/assets/js/3.391fe791.js"><link rel="prefetch" href="/assets/js/30.f2a2d9c6.js"><link rel="prefetch" href="/assets/js/31.e56495af.js"><link rel="prefetch" href="/assets/js/32.a346b474.js"><link rel="prefetch" href="/assets/js/33.ce475055.js"><link rel="prefetch" href="/assets/js/34.413e29a9.js"><link rel="prefetch" href="/assets/js/35.839fa239.js"><link rel="prefetch" href="/assets/js/36.4db4be0e.js"><link rel="prefetch" href="/assets/js/37.16727742.js"><link rel="prefetch" href="/assets/js/38.a0654948.js"><link rel="prefetch" href="/assets/js/39.69f3981a.js"><link rel="prefetch" href="/assets/js/4.a04ccb9d.js"><link rel="prefetch" href="/assets/js/40.89464b71.js"><link rel="prefetch" href="/assets/js/41.3ffac7cc.js"><link rel="prefetch" href="/assets/js/42.48489876.js"><link rel="prefetch" href="/assets/js/43.9e42117c.js"><link rel="prefetch" href="/assets/js/44.f0191db4.js"><link rel="prefetch" href="/assets/js/45.b77db7cb.js"><link rel="prefetch" href="/assets/js/46.33739bdd.js"><link rel="prefetch" href="/assets/js/47.8bf52a09.js"><link rel="prefetch" href="/assets/js/48.3f9b93b9.js"><link rel="prefetch" href="/assets/js/5.4aba4ca2.js"><link rel="prefetch" href="/assets/js/6.c3403115.js"><link rel="prefetch" href="/assets/js/7.6acff8ff.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.aae61d50.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d74e1dbf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">OWASP-Application-Gateway</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="https://app.swaggerhub.com/apis-docs/gianlucafrei/OAG/0.4#/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Swagger
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://owasp.org/www-project-application-gateway/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OWASP
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/The-OAG-Development-Project/Application-Gateway/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link router-link-active">
  Documentation
</a></div><div class="nav-item"><a href="https://app.swaggerhub.com/apis-docs/gianlucafrei/OAG/0.4#/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Swagger
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://owasp.org/www-project-application-gateway/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  OWASP
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/The-OAG-Development-Project/Application-Gateway/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Getting Started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/docs/Terms-you-need-to-understand.html" class="sidebar-link">Terms you need to understand</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Configuration</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/Configuration.html" class="sidebar-link">Overview</a></li><li><a href="/docs/Configuration-File.html" class="sidebar-link">OAG Configuration File</a></li><li><a href="/docs/Configuration-Login-Providers.html" class="sidebar-link">Login Providers</a></li><li><a href="/docs/Configuration-Routes.html" class="sidebar-link">Routes</a></li><li><a href="/docs/Configuration-SecurityProfiles.html" aria-current="page" class="active sidebar-link">Security Profiles</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/Configuration-SecurityProfiles.html#configuration" class="sidebar-link">Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/Configuration-SecurityProfiles.html#predefined-profiles" class="sidebar-link">Predefined Profiles</a></li><li class="sidebar-sub-header"><a href="/docs/Configuration-SecurityProfiles.html#details" class="sidebar-link">Details</a></li></ul></li><li><a href="/docs/Configuration-Session-Behaviour.html" class="sidebar-link">Session Behaviour</a></li><li><a href="/docs/Tracing-Log-Correlation-Correlation-Logging.html" class="sidebar-link">Tracing, Log Correlation, Correlation Logging</a></li><li><a href="/docs/Configuration-User-Mapping.html" class="sidebar-link">User Mapping</a></li><li><a href="/docs/Key-management-and-JWT-signer.html" class="sidebar-link">Key management and JWT signer</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Custom code extensions</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>OAG API endpoints</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Integrating with OAG</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>How To's</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="security-profiles"><a href="#security-profiles" class="header-anchor">#</a> Security Profiles</h1> <p>Security profiles allow you to define different security behavior for different routes. OAG already comes with a predefined set of security profiles that cover most use-cases. However, you can always add your own profile in the config file or overwrite a default security profile.</p> <p>Example:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">securityProfiles</span><span class="token punctuation">:</span>
  <span class="token key atrule">webapplication</span><span class="token punctuation">:</span>
    <span class="token key atrule">allowedMethods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PUT&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PATCH&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DELETE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;OPTIONS&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HEAD&quot;</span> <span class="token punctuation">]</span>
    <span class="token key atrule">csrfProtection</span><span class="token punctuation">:</span> sameSiteStrictCookie
    <span class="token key atrule">csrfSafeMethods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;OPTIONS&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HEAD&quot;</span> <span class="token punctuation">]</span>
    <span class="token key atrule">responseHeaders</span><span class="token punctuation">:</span>
      <span class="token key atrule">Server</span><span class="token punctuation">:</span> &lt;&lt;remove<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span>
      <span class="token key atrule">X-Powered-By</span><span class="token punctuation">:</span> &lt;&lt;remove<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span>
      <span class="token key atrule">X-XSS-Protection</span><span class="token punctuation">:</span> 1; mode=block;
      <span class="token key atrule">X-Frame-Options</span><span class="token punctuation">:</span> SAMEORIGIN
      <span class="token key atrule">X-Content-Type-Options</span><span class="token punctuation">:</span> nosniff
      <span class="token key atrule">Referrer-Policy</span><span class="token punctuation">:</span> strict<span class="token punctuation">-</span>origin<span class="token punctuation">-</span>when<span class="token punctuation">-</span>cross<span class="token punctuation">-</span>origin
      <span class="token key atrule">Content-Security-Policy</span><span class="token punctuation">:</span> upgrade<span class="token punctuation">-</span>insecure<span class="token punctuation">-</span>requests;base<span class="token punctuation">-</span>uri 'self';object<span class="token punctuation">-</span>src 'self'
      <span class="token key atrule">Permissions-Policy</span><span class="token punctuation">:</span> geolocation=()<span class="token punctuation">,</span>notifications=()<span class="token punctuation">,</span>push=()<span class="token punctuation">,</span>microphone=()<span class="token punctuation">,</span>camera=()<span class="token punctuation">,</span>speaker=()<span class="token punctuation">,</span>vibrate=()<span class="token punctuation">,</span>fullscreen=()<span class="token punctuation">,</span>payment=()<span class="token punctuation">,</span>usb=()<span class="token punctuation">,</span>magnetometer=()<span class="token punctuation">,</span>gyroscope=()<span class="token punctuation">,</span>accelerometer=()
      <span class="token key atrule">Strict-Transport-Security</span><span class="token punctuation">:</span> max<span class="token punctuation">-</span>age=31536000; includeSubDomains
</code></pre></div><h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <h3 id="allowedmethods"><a href="#allowedmethods" class="header-anchor">#</a> <code>allowedMethods</code></h3> <p>Defines the allowed HTTP method. Requests with HTTP methods that are not whitelisted will be blocked with a <code>405 Method Not Allowed</code> response.</p> <h3 id="csrfprotection"><a href="#csrfprotection" class="header-anchor">#</a> <code>csrfProtection</code></h3> <p>Defines the type of CSRF Protection. Please check <a href="#csrf-protections">here</a> for more details.</p> <h3 id="csrfsafemethods"><a href="#csrfsafemethods" class="header-anchor">#</a> <code>csrfSafeMethods</code></h3> <p>Defines the list of HTTP methods that are excluded from the CSRF protection.</p> <h3 id="responseheaders"><a href="#responseheaders" class="header-anchor">#</a> <code>responseHeaders</code></h3> <p>Defines actions for response headers. Currently, the following types are supported:</p> <ul><li><code>&lt;&lt;remove&gt;&gt;</code> Removes the header from the response.</li> <li><code>value</code> sets or overwrites the header in the response.</li></ul> <h3 id="usermapping"><a href="#usermapping" class="header-anchor">#</a> <code>userMapping</code></h3> <p>Defines the way how OAG tells the backend who the user is. <br>
See also: <a href="/docs/Configuration-User-Mapping">User Mapping</a></p> <h2 id="predefined-profiles"><a href="#predefined-profiles" class="header-anchor">#</a> Predefined Profiles</h2> <ul><li><code>static</code>: This is for static content. It adds default security headers and only allowed the GET, HEAD, and OPTIONS method. If you have a single page application this is profile is suitable to host static application files.</li> <li><code>webapplication</code>: This profile is suitable for most webapplications. It allows all default normal http methods and adds csrf protection via samesite cookie.</li> <li><code>apiforspa</code> Use this profile if you have an API that is called from the web-browser. It adds csrf protection with the double submit cookit pattern. You need to implement the custom header when you call the api from your code.</li> <li><code>apifornonebrowsers</code>  Use this profile only for apis that are not called from the browser. It removes most security functionality of OAG.</li></ul> <p>You can see the detailed configuration of all predefined profiles in the default configuration file <a href="https://github.com/gianlucafrei/nellygateway/blob/main/nellygateway/src/main/resources/default-config.yaml" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="details"><a href="#details" class="header-anchor">#</a> Details</h2> <p>A security profile consists of the following configuration values:</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code>   <span class="token key atrule">allowedMethods</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PUT&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">]</span> <span class="token comment"># List if allowed http methods</span>
   <span class="token key atrule">csrfProtection</span><span class="token punctuation">:</span> doubleSubmitCookie <span class="token comment"># type of csrf protection</span>
   <span class="token key atrule">responseHeaders</span><span class="token punctuation">:</span> <span class="token comment">#Here you can add a set of response header</span>
      <span class="token key atrule">Server</span><span class="token punctuation">:</span> &lt;&lt;remove<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> <span class="token comment"># Use &lt;&lt;remove&gt;&gt; to remove a header from the backend response</span>
      <span class="token key atrule">X-Content-Type-Options</span><span class="token punctuation">:</span> nosniff <span class="token comment"># OAG adds the X-Content-Type-Options with the nosniff value to each response. Existing header will be overwritten.</span>
      <span class="token comment"># You can add as many different headers as you want</span>
</code></pre></div><h3 id="csrf-protections"><a href="#csrf-protections" class="header-anchor">#</a> CSRF Protections</h3> <p>OAG implements the following strategies for csrf protection.</p> <h4 id="doublesubmitcookie"><a href="#doublesubmitcookie" class="header-anchor">#</a> <code>doubleSubmitCookie</code></h4> <p>With this mode OAG requires the <code>csrf</code> cookie in the <code>X-CSRF-TOKEN</code> header. This method of csrf protection in only applicable for XHR requests and recommened when you have a singe page application. If you use form posts you can also add the token as a hidden field with name <code>CSRFToken</code> to the form.</p> <p>This method of csrf protection is the strongest because OAG cryptographically binds the csrf cookie to the session cookie, but the downside of this method is that your application needs to implement the following logic for every XHR request:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span><span class="token operator">&gt;</span>
    <span class="token keyword">function</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">var</span> nameEQ <span class="token operator">=</span> name <span class="token operator">+</span> <span class="token string">&quot;=&quot;</span><span class="token punctuation">;</span>
       <span class="token keyword">var</span> ca <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> ca<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> c <span class="token operator">=</span> ca<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">' '</span><span class="token punctuation">)</span> c <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>c<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>nameEQ<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>nameEQ<span class="token punctuation">.</span>length<span class="token punctuation">,</span>c<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> csrf_token <span class="token operator">=</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token string">'csrf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">csrfSafeMethod</span><span class="token punctuation">(</span><span class="token parameter">method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// these HTTP methods do not require CSRF protection</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^(GET|HEAD|OPTIONS)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>open<span class="token punctuation">;</span>
    <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">open</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token function">o</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> err <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">csrfSafeMethod</span><span class="token punctuation">(</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'X-CSRF-TOKEN'</span><span class="token punctuation">,</span> csrf_token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> res<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
 <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><hr> <h4 id="samesitestrictcookie"><a href="#samesitestrictcookie" class="header-anchor">#</a> <code>sameSiteStrictCookie</code></h4> <p>With this mode, OAG uses a same-site strict cookie to protect your users from csrf attacks.</p> <p>Most browsers except InternetExplorer do implement the same-site strict cookie. See <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite" target="_blank" rel="noopener noreferrer">SameSite Cookie<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <hr> <h4 id="none"><a href="#none" class="header-anchor">#</a> <code>none</code></h4> <p>OAG does not protect you against any csrf attack. Use this if your route does not need any csrf protection (for example only static content) or if you implemented csrf protection in your backend</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/Configuration-Routes.html" class="prev">
        Routes
      </a></span> <span class="next"><a href="/docs/Configuration-Session-Behaviour.html">
        Session Behaviour
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.80938ac1.js" defer></script><script src="/assets/js/2.699db687.js" defer></script><script src="/assets/js/1.6f7f3e11.js" defer></script><script src="/assets/js/28.a821b188.js" defer></script>
  </body>
</html>
