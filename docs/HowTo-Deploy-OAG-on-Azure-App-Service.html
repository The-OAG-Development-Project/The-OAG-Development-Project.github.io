<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deploy OAG on Azure App Service | OWASP-Application-Gateway</title>
    <meta name="description" content="OWASP Application Gateway is an HTTP proxy that handles Oauth2 authentication and session management">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/assets/style.BgQj3CDO.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CSu29m63.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.DrMgMbKA.js">
    <link rel="modulepreload" href="/assets/chunks/framework.C9w-46Qr.js">
    <link rel="modulepreload" href="/assets/docs_HowTo-Deploy-OAG-on-Azure-App-Service.md.C1vMSHeE.lean.js">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!----><span data-v-1e38c6bc>OWASP-Application-Gateway</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/docs/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Documentation</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://app.swaggerhub.com/apis-docs/gianlucafrei/OAG/0.4#/" target="_blank" rel="noreferrer" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Swagger</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://owasp.org/www-project-application-gateway/" target="_blank" rel="noreferrer" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>OWASP</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Getting Started</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Terms-you-need-to-understand.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Terms you need to understand</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 collapsible collapsed" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Configuration</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d81de50c><span class="vpi-chevron-right caret-icon" data-v-d81de50c></span></div></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Configuration.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Configuration-File.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Configuration File</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Csrf-Protection.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>CSRF Protection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Configuration-Login-Providers.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Login Providers</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Configuration-Routes.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Routes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Configuration-SecurityProfiles.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Security Profiles</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Configuration-Session-Behaviour.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Session Behaviour</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Tracing-Log-Correlation-Correlation-Logging.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Tracing, Correlation-Logging</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Configuration-User-Mapping.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>User Mapping</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Key-management-and-JWT-signer.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Key management and JWT signer</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/TLS-configuration.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Configure TLS and the certificate used by OAG</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 collapsible collapsed" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Custom code extensions</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d81de50c><span class="vpi-chevron-right caret-icon" data-v-d81de50c></span></div></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Custom-(code)-extensions.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Logging.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Logging</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Tracing-Log-Correlation.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Tracing, Log correlation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/JWT-Signer-(add-custom-new-signature-type-to-JWT).html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>JWT Signer and custom signature type</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Automatic-Key-Rotation.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Key Rotation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Csrf-Protection.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>CSRF Protection</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 collapsible collapsed" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>OAG API endpoints</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d81de50c><span class="vpi-chevron-right caret-icon" data-v-d81de50c></span></div></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/OAG-API---endpoints.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>API Endpoints</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/JWKS-JWT-signing-public-keys-of-OAG.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Jwks Endpoint (public signing key)</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 collapsible collapsed" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Integrating with OAG</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d81de50c><span class="vpi-chevron-right caret-icon" data-v-d81de50c></span></div></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Integrating-with-OAG.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Validating-user-identity.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>User identity validation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Token-Validation-with-Java-Spring.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Token validation (Spring/Java)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Whitelisting-of-URL&#39;s-(What-URLs-are-required-by-OAG).html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>URL Whitelisting / OAG provided URL</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 collapsible collapsed has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>How To's</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d81de50c><span class="vpi-chevron-right caret-icon" data-v-d81de50c></span></div></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/HowTo-Deploy-OAG-on-Azure-App-Service.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Deploy to Azure</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Setup-for-OAG-development.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Developer Setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Update-Documentation.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Update Documentation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/docs/Create-a-new-Release.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Create a new Release</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _docs_HowTo-Deploy-OAG-on-Azure-App-Service" data-v-7011f0d8><div><h1 id="deploy-oag-on-azure-app-service" tabindex="-1">Deploy OAG on Azure App Service <a class="header-anchor" href="#deploy-oag-on-azure-app-service" aria-label="Permalink to ‚ÄúDeploy OAG on Azure App Service‚Äù">‚Äã</a></h1><p>This article describes the needed setting to successfully deploy OAG on a Azure App Service Instance. In fact, this is the current setup for the demo instance deployed <a href="https://oag.azurewebsites.net" target="_blank" rel="noreferrer">here</a>.</p><h2 id="create-a-linux-based-docker-app-service" tabindex="-1">Create a Linux based Docker App Service <a class="header-anchor" href="#create-a-linux-based-docker-app-service" aria-label="Permalink to ‚ÄúCreate a Linux based Docker App Service‚Äù">‚Äã</a></h2><h3 id="create-an-app-service-instance" tabindex="-1">Create an App Service Instance <a class="header-anchor" href="#create-an-app-service-instance" aria-label="Permalink to ‚ÄúCreate an App Service Instance‚Äù">‚Äã</a></h3><p>First you need to create a app service instance. It is important that you select Docker as publishing method and Linux as operating system. In this example a Azure app service plan already exists. You need to create a new app service plan if you don&#39;t have a linux plan.</p><p><img src="/assets/1-aas-basics.CCal61Nr.png" alt=""></p><h3 id="configure-the-docker-image" tabindex="-1">Configure the Docker Image <a class="header-anchor" href="#configure-the-docker-image" aria-label="Permalink to ‚ÄúConfigure the Docker Image‚Äù">‚Äã</a></h3><p>Next you need to add the name and tag from the official release on DockerHub. You should select the latest release and not any of the snapshot version because it is more safe to pin the exact version you want. Otherwise the app service might pull a new version when it restarts.</p><p><img src="/assets/2-aas-docker.BuHEMpFy.png" alt=""></p><h3 id="configure-the-network-port" tabindex="-1">Configure the Network Port <a class="header-anchor" href="#configure-the-network-port" aria-label="Permalink to ‚ÄúConfigure the Network Port‚Äù">‚Äã</a></h3><p>After you created the resources there are some settings that you need to adjust. Because the app service environment does not know, on which port OAG ist listening (8080 per default) you need to specify that over the following app service setting:</p><p><code>WEBSITES_PORT=8080</code></p><p><img src="/assets/3-aas-settings.jX9BvxzX.png" alt=""></p><p>After you have saved the new setting Azure will restart the app service. This usually takes some time because Azure seems to pull the image again which is quite slow. You can use the log stream to view the progress. If you don&#39;t see anything yet, please be patient.</p><p>After you have seen the following log your OAG deployment is ready to serve its first request. Visit the url of your app service and you should find an example page.</p><p><code>Container ... for site ... initialized successfully and is ready to serve requests.</code></p><h3 id="persist-oag-logs" tabindex="-1">Persist OAG Logs <a class="header-anchor" href="#persist-oag-logs" aria-label="Permalink to ‚ÄúPersist OAG Logs‚Äù">‚Äã</a></h3><p>Next, please make sure the logs from your OAG instance are persisted with the App Service Logs settings. You can choose a different quota.</p><p><img src="/assets/6-aas-app-service-logs.CcqccO01.png" alt=""></p><p>From now on you should also see the OAG logs with the log stream features:</p><p><img src="/assets/7-aas-logs-2.BslvO-Od.png" alt=""></p><h3 id="visit-your-oag-instance" tabindex="-1">Visit your OAG instance üéâ <a class="header-anchor" href="#visit-your-oag-instance" aria-label="Permalink to ‚ÄúVisit your OAG instance‚Äù">‚Äã</a></h3><p>Congratulations, you have a minimal running instance of OAG. Next step will be to upload you on custom configuration file.</p><p><img src="/assets/5-httpbin.BGRfgNXq.png" alt=""></p><h2 id="upload-your-custom-configuration-file" tabindex="-1">Upload your custom configuration file <a class="header-anchor" href="#upload-your-custom-configuration-file" aria-label="Permalink to ‚ÄúUpload your custom configuration file‚Äù">‚Äã</a></h2><p>Azure app service has the possibility to mount persistent storage to your docker container, we will use that for your custom OAG configuration file. After you activated the persistent storage you can upload the config file via SFTP.</p><h3 id="enable-app-service-storage" tabindex="-1">Enable App Service Storage <a class="header-anchor" href="#enable-app-service-storage" aria-label="Permalink to ‚ÄúEnable App Service Storage‚Äù">‚Äã</a></h3><p>First, add the following setting to you app service settings:</p><p><code>WEBSITES_ENABLE_APP_SERVICE_STORAGE=true</code></p><h3 id="configure-your-deployment-credentials" tabindex="-1">Configure your Deployment Credentials <a class="header-anchor" href="#configure-your-deployment-credentials" aria-label="Permalink to ‚ÄúConfigure your Deployment Credentials‚Äù">‚Äã</a></h3><p>Then you need to define a password for SFTP deployment via &quot;Deployment Center/FTPS Settings&quot; unless you did this already for another service on your app service plan. After you noted the password you just set go the properties page and look up the connection settings. Use a program like Cyberduck to connect to the SFTP service of Azure. (Of course you can also automate this in a CI/CD pipeline)</p><p><img src="/assets/10-cyberduckLogin.CRxCXDWs.png" alt=""></p><p>Here is an example of a minimalistic OAG configuration:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">hostUri</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">env:HOSTURI</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">routes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">apiforspa</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/**</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://nellydemoapp.azurewebsites.net</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    allowAnonymous</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">yes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">loginProviders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  google</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">oidc</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      authEndpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://accounts.google.com/o/oauth2/auth</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      tokenEndpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://oauth2.googleapis.com/token</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      clientId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">env:GOOGLE_CLIENT_ID</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      clientSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">env:GOOGLE_CLIENT_SECRET</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      scopes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [ </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;openid&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;profile&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h3 id="upload-your-configuration-file" tabindex="-1">Upload your Configuration File <a class="header-anchor" href="#upload-your-configuration-file" aria-label="Permalink to ‚ÄúUpload your Configuration File‚Äù">‚Äã</a></h3><p>Before you upload the configuration file it make sense to use a local instance of OAG to verify that it contains no errors. It much faster way than to debug via the app service.</p><p><img src="/assets/11-cyberduck-files.DiRCEEjY.png" alt=""></p><h3 id="configure-the-oag-config-file-path" tabindex="-1">Configure the OAG Config File Path <a class="header-anchor" href="#configure-the-oag-config-file-path" aria-label="Permalink to ‚ÄúConfigure the OAG Config File Path‚Äù">‚Äã</a></h3><p>After you uploaded the file via SFTP you need to add the following app service settings:</p><p><code>OAG_CONFIG_PATH=/home/oag-config-azure.yaml</code> Or whichever name you gave the file. But note the /home/ prefix because the SFTP folder is mounted on the /home path.</p><h3 id="configure-settings-with-the-env-prefix" tabindex="-1">Configure settings with the <code>env:</code> Prefix <a class="header-anchor" href="#configure-settings-with-the-env-prefix" aria-label="Permalink to ‚ÄúConfigure settings with the env: Prefix‚Äù">‚Äã</a></h3><p>Did you note that the &quot;env:&quot; prefix in the configuration file to reference a environment variable? Since app service settings are injected via environment variable you should also add the actual path of your OAG as app service setting. In our case this looks like follows:</p><p><code>HOSTURI=https://oag-test.azurewebsites.net</code></p><p>If you want to test the login with Google you need to create your own client_id and client_secret via the Google api console. In this case you also need to add the following app service settings:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>GOOGLE_CLIENT_ID=&lt;your client id&gt;</span></span>
<span class="line"><span>GOOGLE_CLIENT_ID=&lt;your client secret&gt;</span></span></code></pre></div><p>After you saved the settings the app service restarts and OAG will load the new configuration file. If you cannot connect to you OAG instance please check the logs for error messages. If everything goes will you&#39;ll see the new route that you configured.</p><h3 id="verify-the-new-configuration" tabindex="-1">Verify the new Configuration <a class="header-anchor" href="#verify-the-new-configuration" aria-label="Permalink to ‚ÄúVerify the new Configuration‚Äù">‚Äã</a></h3><p>You can also verify the login functionality by accessing <code>/auth/google/login</code> If you configured you client_id and client_secret correctly you will have an active session and can check that via the <code>/auth/session</code> endpoint.</p><h2 id="further-things-to-do-optional" tabindex="-1">Further things to do (optional): <a class="header-anchor" href="#further-things-to-do-optional" aria-label="Permalink to ‚ÄúFurther things to do (optional):‚Äù">‚Äã</a></h2><ul><li>Disable unencrypted FTP via &quot;Configuration/General settings/FTP state&quot;</li><li>Enable support for HTTP2 via &quot;Configuration/General settings/HTTP Version&quot;</li><li>Configure a custom domain via Custom domains the &quot;Custom Domain&quot; settings</li><li>Reduce the attack surface using private networking between OAG and your backend services</li><li>Enable Azure Log Analytics and forward the OAG logs to a Azure Log Analytics workspace</li><li>Enable health checks with the Health setting</li></ul></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/docs/Whitelisting-of-URL&#39;s-(What-URLs-are-required-by-OAG).html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Previous page</span><span class="title" data-v-e257564d>URL Whitelisting / OAG provided URL</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/docs/Setup-for-OAG-development.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next page</span><span class="title" data-v-e257564d>Developer Setup</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-1df9f90f data-v-c3855bb3><div class="container" data-v-c3855bb3><p class="message" data-v-c3855bb3>Open-source Apache 2 Licensed | Powered by a lot of love ‚ù§Ô∏è (and code)</p><p class="copyright" data-v-c3855bb3>Copyright ¬© OAG Contributors</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"docs_automatic-key-rotation.md\":\"BWSLJ1Br\",\"docs_configuration-file.md\":\"DrFqK40E\",\"docs_configuration-login-providers.md\":\"DR1bqqqN\",\"docs_configuration-routes.md\":\"CfBrHy0Z\",\"docs_configuration-securityprofiles.md\":\"DIpR9bln\",\"docs_configuration-session-behaviour.md\":\"hSPQYZ2Z\",\"docs_configuration-user-mapping.md\":\"Cv5u6o2g\",\"docs_configuration.md\":\"Cx2cI0TB\",\"docs_create-a-new-release.md\":\"Ce5n1jW6\",\"docs_csrf-protection.md\":\"BO9KKZha\",\"docs_custom-(code)-extensions.md\":\"DS0Tts65\",\"docs_howto-deploy-oag-on-azure-app-service.md\":\"C1vMSHeE\",\"docs_index.md\":\"D4kVYqDX\",\"docs_integrating-with-oag.md\":\"B7abmQKo\",\"docs_jwks-jwt-signing-public-keys-of-oag.md\":\"C8zJ-bpg\",\"docs_jwt-signer-(add-custom-new-signature-type-to-jwt).md\":\"DHJq784o\",\"docs_key-management-and-jwt-signer.md\":\"DFLEJEVZ\",\"docs_logging.md\":\"C7gYyk2Z\",\"docs_oag-api---endpoints.md\":\"D8bUdhrj\",\"docs_setup-for-oag-development.md\":\"761tceRc\",\"docs_terms-you-need-to-understand.md\":\"Cx9nVTVL\",\"docs_tls-configuration.md\":\"BlrEeSep\",\"docs_token-validation-with-java-spring.md\":\"ZDjLUYvp\",\"docs_tracing-log-correlation-correlation-logging.md\":\"DSvfnAoV\",\"docs_tracing-log-correlation.md\":\"DBCVY1n4\",\"docs_update-documentation.md\":\"DdKDcZvZ\",\"docs_validating-user-identity.md\":\"BP6LHXhe\",\"docs_whitelisting-of-url's-(what-urls-are-required-by-oag).md\":\"DgwiFdLM\",\"index.md\":\"ToP640UU\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"OWASP-Application-Gateway\",\"description\":\"OWASP Application Gateway is an HTTP proxy that handles Oauth2 authentication and session management\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"repo\":\"https://github.com/The-OAG-Development-Project/Application-Gateway/\",\"editLinks\":false,\"docsDir\":\"\",\"editLinkText\":\"\",\"lastUpdated\":false,\"nav\":[{\"text\":\"Documentation\",\"link\":\"/docs/\"},{\"text\":\"Swagger\",\"link\":\"https://app.swaggerhub.com/apis-docs/gianlucafrei/OAG/0.4#/\"},{\"text\":\"OWASP\",\"link\":\"https://owasp.org/www-project-application-gateway/\"}],\"sidebar\":[{\"text\":\"Getting Started\",\"base\":\"/docs\",\"items\":[{\"text\":\"Overview\",\"link\":\"/\"},{\"text\":\"Terms you need to understand\",\"link\":\"/Terms-you-need-to-understand\"}]},{\"text\":\"Configuration\",\"collapsed\":true,\"base\":\"/docs\",\"items\":[{\"text\":\"Overview\",\"link\":\"/Configuration\"},{\"text\":\"Configuration File\",\"link\":\"/Configuration-File\"},{\"text\":\"CSRF Protection\",\"link\":\"/Csrf-Protection\"},{\"text\":\"Login Providers\",\"link\":\"/Configuration-Login-Providers\"},{\"text\":\"Routes\",\"link\":\"/Configuration-Routes\"},{\"text\":\"Security Profiles\",\"link\":\"/Configuration-SecurityProfiles\"},{\"text\":\"Session Behaviour\",\"link\":\"/Configuration-Session-Behaviour\"},{\"text\":\"Tracing, Correlation-Logging\",\"link\":\"/Tracing-Log-Correlation-Correlation-Logging\"},{\"text\":\"User Mapping\",\"link\":\"/Configuration-User-Mapping\"},{\"text\":\"Key management and JWT signer\",\"link\":\"/Key-management-and-JWT-signer\"},{\"text\":\"Configure TLS and the certificate used by OAG\",\"link\":\"/TLS-configuration\"}]},{\"text\":\"Custom code extensions\",\"collapsed\":true,\"base\":\"/docs\",\"items\":[{\"text\":\"Overview\",\"link\":\"/Custom-(code)-extensions\"},{\"text\":\"Logging\",\"link\":\"/Logging\"},{\"text\":\"Tracing, Log correlation\",\"link\":\"/Tracing-Log-Correlation\"},{\"text\":\"JWT Signer and custom signature type\",\"link\":\"/JWT-Signer-(add-custom-new-signature-type-to-JWT)\"},{\"text\":\"Key Rotation\",\"link\":\"/Automatic-Key-Rotation\"},{\"text\":\"CSRF Protection\",\"link\":\"/Csrf-Protection\"}]},{\"text\":\"OAG API endpoints\",\"collapsed\":true,\"base\":\"/docs\",\"items\":[{\"text\":\"API Endpoints\",\"link\":\"/OAG-API---endpoints\"},{\"text\":\"Jwks Endpoint (public signing key)\",\"link\":\"/JWKS-JWT-signing-public-keys-of-OAG\"}]},{\"text\":\"Integrating with OAG\",\"collapsed\":true,\"base\":\"/docs\",\"items\":[{\"text\":\"Overview\",\"link\":\"/Integrating-with-OAG\"},{\"text\":\"User identity validation\",\"link\":\"/Validating-user-identity\"},{\"text\":\"Token validation (Spring/Java)\",\"link\":\"/Token-Validation-with-Java-Spring\"},{\"text\":\"URL Whitelisting / OAG provided URL\",\"link\":\"/Whitelisting-of-URL's-(What-URLs-are-required-by-OAG)\"}]},{\"text\":\"How To's\",\"collapsed\":true,\"base\":\"/docs\",\"items\":[{\"text\":\"Deploy to Azure\",\"link\":\"/HowTo-Deploy-OAG-on-Azure-App-Service\"},{\"text\":\"Developer Setup\",\"link\":\"/Setup-for-OAG-development\"},{\"text\":\"Update Documentation\",\"link\":\"/Update-Documentation\"},{\"text\":\"Create a new Release\",\"link\":\"/Create-a-new-Release\"}]}],\"footer\":{\"message\":\"Open-source Apache 2 Licensed | Powered by a lot of love ‚ù§Ô∏è (and code)\",\"copyright\":\"Copyright ¬© OAG Contributors\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>